<!doctype html><html lang="en" xmlns="http://www.w3.org/1999/html"><head>    <meta charset="UTF-8" />    <title>Explosion Guy</title>    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>    <script src="./js/socket.io.js"></script>    <style>        body {            margin: 0;            background: #1a1a1a;        }    </style></head><body><script type="text/javascript">    class Load extends Phaser.Scene {        constructor() {            super('Loading');        }        preload () {            var progressBar = this.add.graphics();            var progressBox = this.add.graphics();            progressBox.fillStyle(0x222222, 0.8);            progressBox.fillRect(240, 270, 320, 50);            var width = this.cameras.main.width;            var height = this.cameras.main.height;            var loadingText = this.make.text({                x: width / 2,                y: height / 2 - 50,                text: 'Loading...',                style: {                    font: '20px monospace',                    fill: '#ffffff'                }            });            loadingText.setOrigin(0.5, 0.5);            var percentText = this.make.text({                x: width / 2,                y: height / 2 - 5,                text: '0%',                style: {                    font: '18px monospace',                    fill: '#ffffff'                }            });            percentText.setOrigin(0.5, 0.5);            var assetText = this.make.text({                x: width / 2,                y: height / 2 + 50,                text: '',                style: {                    font: '18px monospace',                    fill: '#ffffff'                }            });            assetText.setOrigin(0.5, 0.5);            this.load.on('progress', function (value) {                percentText.setText(parseInt(value * 100) + '%');                progressBar.clear();                progressBar.fillStyle(0xffffff, 1);                progressBar.fillRect(250, 280, 300 * value, 30);            });            this.load.on('fileprogress', function (file) {                assetText.setText('Loading asset: ' + file.key);            });            this.load.image("tiles", "assets/tilemaps/tileBild.png");            this.load.spritesheet("player-movement", "assets/player_movement.png",{frameWidth: 32,frameHeight: 32})            this.load.image("player", "assets/player.png")            //Daten aus erstellter JSON Tilemap beziehen            this.load.tilemapTiledJSON("map","assets/tilemaps/explosionGuy.tmj");            this.load.spritesheet("bomb", "assets/bomb.png",{frameWidth: 32,frameHeight: 32});            this.load.spritesheet("explosion", "assets/explosion.png",{frameWidth: 32,frameHeight: 32});            this.load.on('complete', function () {                progressBar.destroy();                progressBox.destroy();                loadingText.destroy();                percentText.destroy();                assetText.destroy();            });        }        create() {            //Animationen            //Bombe & Explosions Animation            this.anims.create({key: 'bomb-idle',                frames: this.anims.generateFrameNumbers('bomb', {start: 0,end: 1}),                repeat: -1,                frameRate: 2            });            this.anims.create({key: 'boom',                frames: this.anims.generateFrameNumbers('explosion', {start: 0,end: 7}),                repeat: 0,                frameRate: 5            });            this.anims.create({key: 'go-left',                frames: this.anims.generateFrameNumbers('player-movement', {start: 1,end: 2}),                repeat: -1,                frameRate: 5            });            this.anims.create({key: 'go-right',                frames: this.anims.generateFrameNumbers('player-movement', {start: 3,end: 4}),                repeat: -1,                frameRate: 5            });            this.anims.create({key: 'go-down',                frames: this.anims.generateFrameNumbers('player-movement', {start: 5,end: 6}),                repeat: -1,                frameRate: 5            });            this.anims.create({key: 'go-up',                frames: this.anims.generateFrameNumbers('player-movement', {start: 7,end: 8}),                repeat: -1,                frameRate: 5            });            this.scene.start('MainLevelScene');        }    }    class MainLevel extends Phaser.Scene {        constructor() {            super('MainLevelScene');        }        create ()        {            // Map JSON von von Tiled laden            const map = this.make.tilemap({key: "map", tileWidth:32, tileHeight:32});            const tileset = map.addTilesetImage("tileBild", "tiles");            // map Layer erstellen aus Tile-Layerdaten            this.walls = map.createLayer("hintergrund", tileset, 0, 0);            this.obstacles = map.createLayer("interaktiv", tileset, 0, 0);            // Kollisions-Eigenschaft sowie Destroy-Eigenschaft aus Layer beziehen            this.walls.setCollisionByProperty({collide:true});            this.obstacles.setCollisionByProperty({collide:true});            this.player = new Player(this, 48, 48);            this.cursors = this.input.keyboard.createCursorKeys();        }        update ()        {            if (this.input.keyboard.checkDown(this.cursors.left, 250))            {                IO.socket.emit("input", {action: 'move', direction: 'left'});                // EIgenschaften des zu begehenden Tiles zuordnen                this.wall = this.walls.getTileAtWorldXY(this.player.x - 32, this.player.y, true);                this.breakable = this.obstacles.getTileAtWorldXY(this.player.x - 32, this.player.y, true);                this.player.play('go-left');                // Wenn Collide-Eigenschaften des zu begehenden Feldes Falsch sind darf gegangen werden                if (!this.wall.properties.collide && !this.breakable.properties.collide)                {                    this.player.x -= 32;                }            }            else if (this.input.keyboard.checkDown(this.cursors.right, 250))            {                IO.socket.emit("input", {action: 'move', direction: 'right'});                this.wall = this.walls.getTileAtWorldXY(this.player.x + 32, this.player.y, true);                this.breakable = this.obstacles.getTileAtWorldXY(this.player.x + 32, this.player.y, true);                this.player.play('go-right');                if (!this.wall.properties.collide && !this.breakable.properties.collide)                {                    this.player.x += 32;                }            }            else if (this.input.keyboard.checkDown(this.cursors.up, 250))            {                IO.socket.emit("input", {action: 'move', direction: 'up'});                this.wall = this.walls.getTileAtWorldXY(this.player.x, this.player.y - 32, true);                this.breakable = this.obstacles.getTileAtWorldXY(this.player.x, this.player.y - 32, true);                this.player.play('go-up');                if (!this.wall.properties.collide && !this.breakable.properties.collide) {                    this.player.y -= 32;                }            }            else if (this.input.keyboard.checkDown(this.cursors.down, 250))            {                IO.socket.emit("input", {action: 'move', direction: 'down'});                this.wall = this.walls.getTileAtWorldXY(this.player.x, this.player.y + 32, true);                this.breakable = this.obstacles.getTileAtWorldXY(this.player.x, this.player.y + 32, true);                this.player.play('go-down');                if (!this.wall.properties.collide && !this.breakable.properties.collide)                {                    this.player.y += 32;                }            }            if (!this.input.keyboard.isDown)            {                this.player.anims.stop();            }            if (this.input.keyboard.checkDown(this.cursors.space))            {                IO.socket.emit("input", {action: 'bomb'});                this.player.dropBomb(this.player.x, this.player.y, isExploding, breakables);            }        }    }    class Player extends Phaser.Physics.Arcade.Sprite{        constructor(scene, x, y, id) {            super(scene, x, y);            this.scene = scene;            this.id = id;            this.name = name;            this.isAlive = isAlive;            this.bomb;            this.time;            this.scene.add.existing(this);            this.scene.physics.add.existing(this);            this.setPosition(x,y);            this.setTexture('player');            this.body.setCollideWorldBounds(true);            this.setScale(1);            if(isAlive === false) {                destroyObj(this);            }        }        dropBomb(x,y, isExploding)        {            this.bomb = new Bomb(this.scene);            this.bomb.setPosition(x,y);            if(isExploding === true){                this.bomb.explode(this);            }        }    }    class Bomb extends Phaser.Physics.Arcade.Sprite {        constructor(scene) {            super(scene);            this.scene = scene;            this.scene.physics.add.existing(this);            this.scene.add.existing(this);            this.setTexture('bomb').play('bomb-idle');            this.body.setCollideWorldBounds(true);            this.setScale(1);            this.body.setBounce(0.8);        }        explode(player, breakables) {            let explosion = new Explosion(this)            for(b of breakables){                this.scene.physics.add.collider(explosion, b);                this.scene.physics.add.overlap(explosion, b, this.kill(b), null, this);            }            this.scene.physics.add.collider(explosion, player);            this.scene.physics.add.overlap(explosion, player, destroyObj(player), null, this);        }    }    class Explosion extends Phaser.Physics.Arcade.Sprite {        constructor(scene) {            super(scene);            this.scene.physics.add.existing(this);            this.scene.add.existing(this);            this.once('animationcomplete', ()=>  {                destroyObj(this);            });        }    }    function destroyObj(obj){        obj.setActive(false);        obj.setVisible(false);    }    const config = {        title: 'Explosion Guy',        type: Phaser.AUTO,        width: 544, //17 x 32        height: 416, //13 x 32        autoCenter: true,        // Bildschirm ausfüllen        scale: {            mode: Phaser.Scale.FIT        },        scene: [Load,MainLevel],        physics: {            default:"arcade", arcade:{                debug:true            }        }    };    const game = new Phaser.Game(config);</script><script src="./js/app.js"></script></body></html>